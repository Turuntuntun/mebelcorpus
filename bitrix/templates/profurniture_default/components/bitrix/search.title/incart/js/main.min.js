"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}(function(a){"use strict";var b=a.BX,c=a.RS,d=function(){function d(a,c){_classCallCheck(this,d),this.container=a,this.params=c,this.templateEngine=void 0,b.Sale.BasketComponent&&this.observeActionPoolRequestProcessing(),this.attachTemplate()}return _createClass(d,[{key:"observeActionPoolRequestProcessing",value:function(){var a=this;if(b.Sale.BasketComponent.actionPool){var c=b.Sale.BasketComponent.actionPool.requestProcessing,d=this;Object.defineProperty(b.Sale.BasketComponent.actionPool,"requestProcessing",{set:function(a){!0==c&&!1==a&&d.updatedBasketComponent(),c=a,this._requestProcessing=a}})}else setTimeout(function(){return a.observeActionPoolRequestProcessing()},500)}},{key:"updatedBasketComponent",value:function(){setTimeout(function(){return b.Sale.BasketComponent.lazyLoad()})}},{key:"updateBasketComponent",value:function(){b.Sale.BasketComponent.actionPool.setRefreshStatus(!1),b.Sale.BasketComponent.actionPool.switchTimer()}},{key:"add2basket",value:function(a){var c=this;return new Promise(function(d){var e={};e[c.params.actionVariable]="BUY",e[c.params.productIdVariable]=a.id;var f=b.util.add_url_param(a.pageUrl,e);b.ajax({url:f,method:"POST",dataType:"json",data:{ajax_basket:"Y"},onsuccess:function(a){b.Sale.BasketComponent&&c.updateBasketComponent(),d(a)}})})}},{key:"attachTemplate",value:function(){var d=this;this.container.innerHTML="",this.templateEngine=b.Vue.create({el:this.container,components:{"redsign-suggestion-items":c.Vue.Components.SuggestionItems},data:function(){return{query:"",isLoading:!1,messageParams:{position:"bottom-left",duration:5e3}}},computed:{localize:function(){return b.Vue.getFilteredPhrases("RS_GOPRO_INCART_SEARCH_")}},template:"\n                    <div>\n                        <div :class=\"{invisible: isLoading}\">\n                            <h4>{{ localize.RS_GOPRO_INCART_SEARCH_ADD_ITEMS }}</h4>\n                            <redsign-suggestion-items \n                                v-model=\"query\"\n                                ajax-path=\"".concat(this.params.ajaxPath,"\"\n                                input-id=\"").concat(this.params.inputId,"\"\n                                :placeholder=\"localize.RS_GOPRO_INCART_SEARCH_INPUT_PLACEHOLDER\"\n                                :min-length=\"").concat(this.params.minLength,"\" \n                                @add=\"add2basket\" \n                                :buttonTitle=\"localize.RS_GOPRO_INCART_SEARCH_BUTTON_TITLE\"\n                            />\n                        </div>\n                        <div v-show=\"isLoading\">\n                            <div class=\"suggestion-items-spinner\"></div>\n                        </div>\n                    </div>\n                "),methods:{reset:function(){this.isLoading=!1,this.query="",$(a).scroll()},message:function(a){"OK"==a.STATUS?this.$toasted.show(a.MESSAGE,this.messageParams):"ERROR"==a.STATUS&&this.$toasted.show(a.MESSAGE,this.messageParams)},add2basket:function(a){this.isLoading=!0,d.add2basket(a).then(this.message).then(this.reset)}}})}}]),d}();a.GoproIncartSearchItems=d})(window);